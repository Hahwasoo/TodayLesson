<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.todaylesson.Mapper.JY_US_MyLessonMapper">
<parameterMap type="java.util.HashMap" id="hashmap"></parameterMap>
<select id="my_lesson_list" resultType="com.todaylesson.DTO.LessonDTO" parameterType="java.lang.String">

select * from lesson where lesson_no in
(select lesson_no from order_detail d join orderlist l
on d.orderlist_no = l.orderlist_no
where member_id = #{member_id}
)

</select>

<select id="mylesson_select" resultType="com.todaylesson.DTO.LessonDetailDTO">

select * from lessondetail where lesson_no = #{lesson_no}

</select>


<select id="my_lesson_detail_this_chapter" resultType="com.todaylesson.DTO.LessonDetailDTO">

select * from lessondetail where lessondetail_no = #{lessondetail_no}

</select>

<select id="my_lesson_name" resultType="java.lang.String">

select lesson_title from lesson where lesson_no = #{lesson_no}

</select>

<insert id="update_lesson_comp" parameterMap="hashmap">

insert into lessoncomp(lesson_no, lessondetail_no, member_id, lessondetail_comp)
value(#{lesson_no}, #{lessondetail_no}, #{member_id}, 1)

</insert>

<select id="select_my_lesson_comp" parameterMap="hashmap" resultType="integer">

select count(*)
from lessoncomp
where lesson_no = #{lesson_no}
and member_id = #{member_id}
and lessondetail_comp = 1
and lessondetail_no = #{lessondetail_no}


</select>

<select id="mylesson_comp_select" parameterMap="hashmap" resultType="com.todaylesson.DTO.LessonCompDTO">

select distinct c.lessondetail_no, c.member_id, c.lesson_no, c.lessondetail_comp, d.lessondetail_chapter from lessondetail d left join lessoncomp c on d.lesson_no = c.lesson_no where c.member_id = 'sn1';

</select>


</mapper>