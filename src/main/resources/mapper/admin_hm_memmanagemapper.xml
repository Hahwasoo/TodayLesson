<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.todaylesson.Mapper.Admin_HM_MemmanageMapper">

<!-- 관리자 회원리스트 출력 -->
<select id="adminmemberlist" resultType="com.todaylesson.DTO.MemberDTO">
select member_no,member_id,member_name,member_nick,member_point,member_level,member_join_date
from member
order by member_no
</select>


<!-- 회원 레벨 변경 -->
<update id="adminlevelupdate" parameterType="HashMap">
update member
set member_level = #{member_level}
where member_id = #{member_id}
</update>

<!-- 회원 레벨이 변경됐을 시 회원 등급별 권한 변경 -->
<update id="adminmemberauthupdate" parameterType="HashMap">
update member_auth a inner join member b
on a.member_id = b.member_id
<choose>
<when test='member_level==0'>
set a.member_auth = 'ROLE_ADMIN'
</when>
<when test='member_level==1'>
set a.member_auth = 'ROLE_USER' 
</when>
<when test='member_level==2'>
set a.member_auth = 'ROLE_SENIOR'
</when>
</choose>
where a.member_id = #{member_id}
</update>
 
 
</mapper>